<div id="usernameContainer">
  <h2>Enter your username to start chatting</h2>
  <input type="text" id="usernameInput" placeholder="Your username" />
  <button id="startChat">Start Chat</button>
</div>

<div id="chatContainer" class="hidden">
  <div id="statusText">Looking for a partner...</div>
  <div id="messageContainer"></div>
  <div id="inputContainer">
    <textarea
      id="messageInput"
      placeholder="Type a message..."
      rows="1"
    ></textarea>
    <button id="sendButton">âž¤</button>
  </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io("https://your-backend-url.onrender.com");
  let username;

  document.getElementById("startChat").addEventListener("click", () => {
    username = document.getElementById("usernameInput").value.trim();
    if (username) {
      document.getElementById("usernameContainer").classList.add("hidden");
      document.getElementById("chatContainer").classList.remove("hidden");
      socket.emit("join", username);
    }
  });

  const messageInput = document.getElementById("messageInput");
  messageInput.addEventListener("input", () => {
    messageInput.style.height = "auto";
    messageInput.style.height = `${messageInput.scrollHeight}px`;
  });

  document.getElementById("sendButton").addEventListener("click", () => {
    const message = messageInput.value.trim();
    if (message) {
      socket.emit("message", { username, message });
      messageInput.value = "";
      messageInput.style.height = "40px";
    }
  });

  socket.on("message", (data) => {
    const msg = document.createElement("div");
    msg.textContent = `${data.username}: ${data.message}`;
    document.getElementById("messageContainer").appendChild(msg);
  });
</script>

<style>
  #inputContainer {
    display: flex;
    align-items: center;
    padding: 10px;
  }
  #messageInput {
    flex: 1;
    padding: 8px;
    resize: none;
    overflow-y: hidden;
  }
  #sendButton {
    margin-left: 10px;
    font-size: 20px;
    background: none;
    border: none;
    cursor: pointer;
  }
</style>
